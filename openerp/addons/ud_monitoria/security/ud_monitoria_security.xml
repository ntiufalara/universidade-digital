<?xml version="1.0" encoding="UTF-8"?>

<openerp>
    <data noupdate="0">
        <record model="ir.module.category" id="module_category_ud_monitoria">
            <field name="name">Monitoria</field>
        </record>

        <!-- =================== -->
        <!-- GRUPOS DE SEGURANÇA -->
        <!-- =================== -->
        <record id="group_ud_monitoria_monitor" model="res.groups">
            <field name="name">Monitor/Tutor</field>
            <field name="category_id" ref="module_category_ud_monitoria"/>
            <field name="implied_ids" eval="[(4, ref('base.usuario_ud'))]"/>
            <field name="comment">Usuários desse grupo podem acessar e alterar alguns de seus dados, tal como horários de trabalho, anexar relatórios e frequências, fazer downloads de certificados, etc.</field>
        </record>

        <record id="group_ud_monitoria_orientador" model="res.groups">
            <field name="name">Orientador</field>
            <field name="category_id" ref="module_category_ud_monitoria"/>
            <field name="implied_ids" eval="[(4, ref('base.usuario_ud'))]"/>
            <field name="comment">Acesso aos seus dados assim como alteração e gerência dos dados de seus monitores.</field>
        </record>

        <record id="group_ud_monitoria_coord_disciplina" model="res.groups">
            <field name="name">Coordenador de Monitoria de Curso</field>
            <field name="category_id" ref="module_category_ud_monitoria"/>
            <field name="implied_ids" eval="[(4, ref('base.usuario_ud'))]"/>
            <field name="comment">Coordenador de Monitoria de algum curso.</field>
        </record>

        <record id="group_ud_monitoria_coordenador" model="res.groups">
            <field name="name">Coordenador Geral</field>
            <field name="category_id" ref="module_category_ud_monitoria"/>
            <field name="implied_ids" eval="[(4, ref('base.usuario_ud'))]"/>
            <field name="comment">Coordenador do setor de Monitoria.</field>
        </record>

        <record id="group_ud_monitoria_administrador" model="res.groups">
            <field name="name">Administrador</field>
            <field name="category_id" ref="module_category_ud_monitoria"/>
            <field name="implied_ids" eval="[(4, ref('base.usuario_ud'))]"/>
            <field name="comment">Privilégios elevados sobre o módulo.</field>
            <field name="users" eval="[(4, ref('base.user_root'))]"/>
        </record>

        <!-- =================== -->
        <!-- REGRAS DE SEGURANÇA -->
        <!-- =================== -->
        <!-- Bolsas de Curso -->
        <record id="rule_ud_monitoria_bolsas_curso_coordenador_curso" model="ir.rule">
            <field name="name">Coordenador de curso: Bolsas de curso (UD)</field>
            <field name="model_id" ref="model_ud_monitoria_bolsas_curso"/>
            <field name="domain_force">[('coord_monitoria_id.user_id.id', '=', user.id)]</field>
            <field name="groups" eval="[(4, ref('ud_monitoria.group_ud_monitoria_coord_disciplina'))]"/>
            <field name="perm_create" eval="False"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_read" eval="False"/>
            <field name="perm_unlink" eval="False"/>
        </record>

        <record id="rule_ud_monitoria_bolsas_curso_coordenador_admin" model="ir.rule">
            <field name="name">Coordenador e Admin: Bolsas de curso (UD)</field>
            <field name="model_id" ref="model_ud_monitoria_bolsas_curso"/>
            <field name="groups" eval="[(4, ref('ud_monitoria.group_ud_monitoria_coordenador')), (4, ref('ud_monitoria.group_ud_monitoria_administrador'))]"/>
            <field name="perm_create" eval="False"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_read" eval="False"/>
            <field name="perm_unlink" eval="False"/>
        </record>

        <!-- Disciplina -->
        <record id="rule_ud_monitoria_disciplina_coord_curso" model="ir.rule">
            <field name="name">Coordenador de curso: Disciplina (UD)</field>
            <field name="model_id" ref="model_ud_monitoria_disciplina"/>
            <field name="domain_force">[('bolsas_curso_id.coord_monitoria_id.user_id.id', '=', user.id)]</field>
            <field name="groups" eval="[(4, ref('ud_monitoria.group_ud_monitoria_coord_disciplina'))]"/>
            <field name="perm_create" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_read" eval="False"/>
            <field name="perm_unlink" eval="True"/>
        </record>

        <record id="rule_ud_monitoria_disciplina_coordenador_admin" model="ir.rule">
            <field name="name">Coordenador e Admin: Disciplina (UD)</field>
            <field name="model_id" ref="model_ud_monitoria_disciplina"/>
            <field name="groups" eval="[(4, ref('ud_monitoria.group_ud_monitoria_coordenador')), (4, ref('ud_monitoria.group_ud_monitoria_administrador'))]"/>
            <field name="perm_create" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_read" eval="False"/>
            <field name="perm_unlink" eval="True"/>
        </record>

        <!-- Processos Seletivos -->
        <record id="rule_ud_monitoria_processo_seletivo" model="ir.rule">
            <field name="name">Usuário: Processo Seletivo (UD)</field>
            <field name="model_id" ref="model_ud_monitoria_processo_seletivo"/>
            <field name="domain_force">[('state', 'in', ['novo', 'andamento', 'encerrado'])]</field>
            <field name="groups" eval="[(4, ref('base.usuario_ud'))]"/>
            <field name="perm_create" eval="False"/>
            <field name="perm_write" eval="False"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_unlink" eval="False"/>
        </record>

        <record id="rule_ud_monitoria_processo_seletivo_coordenador_curso" model="ir.rule">
            <field name="name">Coordenador de curso: Processo Seletivo (UD)</field>
            <field name="model_id" ref="model_ud_monitoria_processo_seletivo"/>
            <field name="domain_force">[('state', 'in', ['demanda'])]</field>
            <field name="groups" eval="[(4, ref('ud_monitoria.group_ud_monitoria_coord_disciplina'))]"/>
            <field name="perm_create" eval="False"/>
            <field name="perm_write" eval="False"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_unlink" eval="False"/>
        </record>

        <record id="rule_ud_monitoria_processo_seletivo_coordenador" model="ir.rule">
            <field name="name">Coordenador e Admin: Processo Seletivo (UD)</field>
            <field name="model_id" ref="model_ud_monitoria_processo_seletivo"/>
            <field name="groups" eval="[(4, ref('ud_monitoria.group_ud_monitoria_coordenador')), (4, ref('ud_monitoria.group_ud_monitoria_administrador'))]"/>
            <field name="perm_create" eval="False"/>
            <field name="perm_write" eval="False"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_unlink" eval="False"/>
        </record>

        <!-- Disciplina de Processo Seletivo -->
        <record id="rule_ud_monitoria_disciplina_ps_coord_curso" model="ir.rule">
            <field name="name">Coordenador de curso: Disciplina PS (UD)</field>
            <field name="model_id" ref="model_ud_monitoria_disciplina_ps"/>
            <field name="domain_force">[('bolsas_curso_id.coord_monitoria_id.user_id.id', '=', user.id)]</field>
            <field name="groups" eval="[(4, ref('ud_monitoria.group_ud_monitoria_coord_disciplina'))]"/>
            <field name="perm_create" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_read" eval="False"/>
            <field name="perm_unlink" eval="True"/>
        </record>

        <record id="rule_ud_monitoria_disciplina_ps_coordenador_admin" model="ir.rule">
            <field name="name">Coordenador e Admin: Disciplina PS (UD)</field>
            <field name="model_id" ref="model_ud_monitoria_disciplina_ps"/>
            <field name="groups" eval="[(4, ref('ud_monitoria.group_ud_monitoria_coordenador')), (4, ref('ud_monitoria.group_ud_monitoria_administrador'))]"/>
            <field name="perm_create" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_read" eval="False"/>
            <field name="perm_unlink" eval="True"/>
        </record>

        <!-- Inscrições -->
        <record id="rule_ud_monitoria_inscricao" model="ir.rule">
            <field name="name">Usuário: Inscrição (UD)</field>
            <field name="model_id" ref="model_ud_monitoria_inscricao"/>
            <field name="domain_force">[('discente_id.user_id.id', '=', user.id)]</field>
            <field name="groups" eval="[(4, ref('base.usuario_ud'))]"/>
            <field name="perm_create" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_unlink" eval="False"/>
        </record>

        <record id="rule_ud_monitoria_inscricao_orientador" model="ir.rule">
            <field name="name">Orientador: Inscrição (UD)</field>
            <field name="model_id" ref="model_ud_monitoria_inscricao"/>
            <field name="domain_force">[('orientador_id.user_id.id', '=', user.id), ('bolsas_curso_id.semestre_id.is_active', '=', True)]</field>
            <field name="groups" eval="[(4, ref('ud_monitoria.group_ud_monitoria_orientador'))]"/>
            <field name="perm_create" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_unlink" eval="False"/>
        </record>

        <record id="rule_ud_monitoria_inscricao_coordenador" model="ir.rule">
            <field name="name">Coordenador e Admin: Inscrição (UD)</field>
            <field name="model_id" ref="model_ud_monitoria_inscricao"/>
            <field name="groups" eval="[(4, ref('ud_monitoria.group_ud_monitoria_coordenador')), (4, ref('ud_monitoria.group_ud_monitoria_administrador'))]"/>
            <field name="perm_create" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_unlink" eval="False"/>
        </record>

        <!-- Pontuação -->
        <record id="rule_ud_monitoria_pontuacao" model="ir.rule">
            <field name="name">Usuário: Pontuação (UD)</field>
            <field name="model_id" ref="model_ud_monitoria_pontuacao"/>
            <field name="domain_force">[('inscricao_id.discente_id.user_id.id', '=', user.id)]</field>
            <field name="groups" eval="[(4, ref('base.usuario_ud'))]"/>
            <field name="perm_create" eval="True"/>
            <field name="perm_write" eval="False"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_unlink" eval="False"/>
        </record>

        <record id="rule_ud_monitoria_pontuacao_orientador" model="ir.rule">
            <field name="name">Orientador: Pontuação (UD)</field>
            <field name="model_id" ref="model_ud_monitoria_pontuacao"/>
            <field name="domain_force">[('inscricao_id.orientador_id.user_id.id', '=', user.id)]</field>
            <field name="groups" eval="[(4, ref('ud_monitoria.group_ud_monitoria_orientador'))]"/>
            <field name="perm_create" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_unlink" eval="False"/>
        </record>

        <record id="rule_ud_monitoria_pontuacao_coordenador" model="ir.rule">
            <field name="name">Coordenador e Admin: Pontuação (UD)</field>
            <field name="model_id" ref="model_ud_monitoria_pontuacao"/>
            <field name="groups" eval="[(4, ref('ud_monitoria.group_ud_monitoria_coordenador')), (4, ref('ud_monitoria.group_ud_monitoria_administrador'))]"/>
            <field name="perm_create" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_unlink" eval="False"/>
        </record>

        <!-- Frequência do discente -->
        <record id="rule_ud_monitoria_frequencia" model="ir.rule">
            <field name="name">Discente: Frequência de discente (UD)</field>
            <field name="model_id" ref="model_ud_monitoria_frequencia"/>
            <field name="domain_force">
                ['|', ('documentos_id.discente_id.user_id.id', '=', user.id), ('documentos_id.orientador_id.user_id.id', '=', user.id)]
            </field>
            <field name="groups" eval="[(4, ref('ud_monitoria.group_ud_monitoria_monitor')), (4, ref('ud_monitoria.group_ud_monitoria_orientador'))]"/>
            <field name="perm_create" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_unlink" eval="False"/>
        </record>

        <record id="rule_ud_monitoria_frequencia_coordenador_curso" model="ir.rule">
            <field name="name">Coordenador de curso: Frequência de discente (UD)</field>
            <field name="model_id" ref="model_ud_monitoria_frequencia"/>
            <field name="groups" eval="[(4, ref('ud_monitoria.group_ud_monitoria_coord_disciplina'))]"/>
            <field name="perm_create" eval="False"/>
            <field name="perm_write" eval="False"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_unlink" eval="False"/>
        </record>

        <record id="rule_ud_monitoria_frequencia_coordenador" model="ir.rule">
            <field name="name">Coordenador e Admin: Frequência de discente (UD)</field>
            <field name="model_id" ref="model_ud_monitoria_frequencia"/>
            <field name="groups" eval="[(4, ref('ud_monitoria.group_ud_monitoria_coordenador')), (4, ref('ud_monitoria.group_ud_monitoria_administrador'))]"/>
            <field name="perm_create" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_unlink" eval="False"/>
        </record>

        <!-- Documentos do discente -->
        <record id="rule_ud_monitoria_documentos_discente_leitura" model="ir.rule">
            <field name="name">Discente: Leitura de Doc. de discente (UD)</field>
            <field name="model_id" ref="model_ud_monitoria_documentos_discente"/>
            <field name="domain_force">
                ['|', '|', ('discente_id.user_id.id', '=', user.id), ('orientador_id.user_id.id', '=', user.id),
                ('disciplina_id.data_inicial', '&lt;=', time.strftime('%Y-%m-%d')),
                ('disciplina_id.data_final', '&gt;=', time.strftime('%Y-%m-%d')),
                ('state', 'in', ['bolsista', 'n_bolsista'])]
            </field>
            <field name="groups" eval="[(4, ref('ud_monitoria.group_ud_monitoria_monitor')), (4, ref('ud_monitoria.group_ud_monitoria_orientador'))]"/>
            <field name="perm_create" eval="False"/>
            <field name="perm_write" eval="False"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_unlink" eval="False"/>
        </record>

        <record id="rule_ud_monitoria_documentos_discente_escrita" model="ir.rule">
            <field name="name">Discente: Edição de Doc. de discente (UD)</field>
            <field name="model_id" ref="model_ud_monitoria_documentos_discente"/>
            <field name="domain_force">
                ['|', ('discente_id.user_id.id', '=', user.id), ('orientador_id.user_id.id', '=', user.id)]
            </field>
            <field name="groups" eval="[(4, ref('ud_monitoria.group_ud_monitoria_monitor')), (4, ref('ud_monitoria.group_ud_monitoria_orientador'))]"/>
            <field name="perm_create" eval="False"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_read" eval="False"/>
            <field name="perm_unlink" eval="False"/>
        </record>

        <record id="rule_ud_monitoria_documentos_discente_coord_curso_leitura" model="ir.rule">
            <field name="name">Coord. de curso: Leitura de Doc. de discente (UD)</field>
            <field name="model_id" ref="model_ud_monitoria_documentos_discente"/>
            <field name="groups" eval="[(4, ref('ud_monitoria.group_ud_monitoria_coord_disciplina'))]"/>
            <field name="perm_create" eval="False"/>
            <field name="perm_write" eval="False"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_unlink" eval="False"/>
        </record>

        <record id="rule_ud_monitoria_documentos_discente_coordenador" model="ir.rule">
            <field name="name">Coordenador e Admin: Doc. de discente (UD)</field>
            <field name="model_id" ref="model_ud_monitoria_documentos_discente"/>
            <field name="groups" eval="[(4, ref('ud_monitoria.group_ud_monitoria_coordenador')), (4, ref('ud_monitoria.group_ud_monitoria_administrador'))]"/>
            <field name="perm_create" eval="False"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_unlink" eval="False"/>
        </record>

        <!-- Horário -->
        <record id="rule_ud_monitoria_horario" model="ir.rule">
            <field name="name">Usuários: Horário (UD)</field>
            <field name="model_id" ref="model_ud_monitoria_horario"/>
            <field name="domain_force">[('documento_id.discente_id.user_id.id', '=', user.id)]</field>
            <field name="perm_create" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_unlink" eval="True"/>
        </record>
    </data>
</openerp>
