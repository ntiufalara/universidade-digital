<?xml version="1.0" encoding="utf-8" ?>

<openerp>
    <data>
        <!-- BOLSAS DE CURSO -->
        <record id="action_ud_monitoria_bolsas_curso_liberacao_disciplina_view" model="ir.actions.act_window">
            <field name="name">Liberação de Disciplinas</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">ud_monitoria.bolsas_curso</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="context">{'coordenador_monitoria_curso': True, 'liberacao_disciplina': True}</field>
            <field name="help" type="html">
                <div>
                    <p>
                        Serão mostrados todos os cursos que você seja Coordenador de Monitoria nos semestres ativos.
                    </p>
                </div>
            </field>
        </record>

        <record id="action_ud_monitoria_bolsas_curso_semestre_view" model="ir.actions.act_window">
            <field name="name">Bolsas de Cursos</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">ud_monitoria.bolsas_curso</field>
            <field name="domain">[('semestre_id', '=', context.get('active_id', False))]</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
        </record>

        <record id="ud_monitoria_bolsas_curso_tree_view" model="ir.ui.view">
            <field name="name">ud_monitoria.bolsas_curso.tree</field>
            <field name="model">ud_monitoria.bolsas_curso</field>
            <field name="type">tree</field>
            <field name="arch" type="xml">
                <tree string="Bolsas de Cursos">
                    <field name="id" invisible="1"/>
                    <field name="curso_id"/>
                    <field name="semestre_id" invisible="not context.get('coordenador_monitoria_curso', True)"/>
                    <field name="bolsas" groups="ud_monitoria.group_ud_monitoria_coord_disciplina,ud_monitoria.group_ud_monitoria_coordenador,ud_monitoria.group_ud_monitoria_administrador"/>
                    <field name="distribuidas" groups="ud_monitoria.group_ud_monitoria_coord_disciplina,ud_monitoria.group_ud_monitoria_coordenador,ud_monitoria.group_ud_monitoria_administrador"/>
                    <field name="disponiveis" groups="ud_monitoria.group_ud_monitoria_coord_disciplina,ud_monitoria.group_ud_monitoria_coordenador,ud_monitoria.group_ud_monitoria_administrador"/>
                    <field name="is_active"/>
                </tree>
            </field>
        </record>

        <record id="ud_monitoria_bolsas_curso_form_view" model="ir.ui.view">
            <field name="name">ud_monitoria.bolsas_curso.form</field>
            <field name="model">ud_monitoria.bolsas_curso</field>
            <field name="type">form</field>
            <field name="arch" type="xml">
                <form string="Bolsas de Curso" version="7.0">
                    <field name="id" invisible="1"/>
                    <group col="8">
                        <field name="semestre_id" colspan="4" attrs="{'readonly': [('id', '!=', False)]}"
                               options="{'no_open': true, 'create_edit': false, 'create': false}"/>
                        <field name="curso_id" colspan="4" attrs="{'readonly': [('id', '!=', False)]}"
                               options="{'create_edit': false, 'create': false}"/>
                    </group>
                    <group string="Informações de bolsas" col="8"
                           groups="ud_monitoria.group_ud_monitoria_coord_disciplina,ud_monitoria.group_ud_monitoria_coordenador,ud_monitoria.group_ud_monitoria_administrador">
                        <field name="bolsas" colspan="4" readonly="1" string="Total"/>
                        <field name="distribuidas" colspan="4" string="Distribuídas"/>
                        <field name="utilizadas" colspan="4" string="Utilizadas"/>
                        <field name="disponiveis" colspan="4" string="Não utilizadas"/>
                    </group>
                    <group string="Disciplinas">
                        <field name="disciplina_ids" nolabel="1" context="{'bolsas_curso_id': id}"/>
                    </group>
                </form>
            </field>
        </record>

        <record id="ud_monitoria_bolsas_curso_coordenador_form" model="ir.ui.view">
            <field name="name">ud_monitoria.bolsas_curso.coordenador.form</field>
            <field name="model">ud_monitoria.bolsas_curso</field>
            <field name="inherit_id" ref="ud_monitoria_bolsas_curso_form_view"/>
            <field name="groups_id" eval="[(6, 0, [ref('ud_monitoria.group_ud_monitoria_coordenador'), ref('ud_monitoria.group_ud_monitoria_administrador')])]"/>
            <field name="arch" type="xml">
                <field name="bolsas" position="attributes">
                    <attribute name="readonly"/>
                </field>
            </field>
        </record>

        <!-- SEMESTRE -->
        <record model="ir.actions.act_window" id="ud_monitoria_semestre_action_view">
            <field name="name">Definições dos Semestres</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">ud_monitoria.semestre</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
        </record>

        <record model="ir.ui.view" id="ud_monitoria_semestre_tree_view">
            <field name="name">ud_monitoria.semestre.tree</field>
            <field name="model">ud_monitoria.semestre</field>
            <field name="type">tree</field>
            <field name="arch" type="xml">
                <tree string="Semestres" colors="blue:is_active == True">
                    <field name="semestre"/>
                    <field name="max_bolsas"/>
                    <field name="data_i_frequencia"/>
                    <field name="intervalo_frequencia"/>
                    <field name="is_active"/>
                </tree>
            </field>
        </record>

        <record model="ir.ui.view" id="ud_monitoria_semestre_form_view">
            <field name="name">ud_monitoria.semestre.form</field>
            <field name="model">ud_monitoria.semestre</field>
            <field name="type">form</field>
            <field name="arch" type="xml">
                <form string="Semestre" version="7.0">
                    <header groups="ud_monitoria.group_ud_monitoria_coordenador,ud_monitoria.group_ud_monitoria_administrador">
                        <button name="desativar_registro" string="Finalizar" type="object"
                                confirm="Realmente deseja finalizar registro atual?"
                                help="Finaliza o registro desse semestre."
                                attrs="{'invisible': ['|', ('is_active', '=', False), ('id', '=', False)]}"/>
                        <button name="ativar_registro" string="Reativar" type="object" groups="ud_monitoria.group_ud_monitoria_administrador"
                                attrs="{'invisible': ['|', ('is_active', '=', True), ('id', '=', False)]}"/>
                        <button name="%(ud_monitoria.action_ud_monitoria_disciplina)d" type="action" string="Disciplinas"
                                groups="ud_monitoria.group_ud_monitoria_coordenador,ud_monitoria.group_ud_monitoria_administrador"
                                context="{'disciplinas_semestre': True, 'semestre_id': id}" attrs="{'invisible': [('id', '=', False)]}"/>
                        <button name="garantir_permissoes_orientadores" string="Permissões de Orientadores" type="object"
                                groups="ud_monitoria.group_ud_monitoria_administrador"
                                attrs="{'invisible': ['|', ('is_active', '=', False), ('id', '=', False)]}"/>

                    </header>
                    <field name="id"/>
                    <group col="4">
                        <field name="semestre" colspan="2" widget="semestre" attrs="{'readonly': [('id', '!=', False)]}"
                               placeholder="Ex.: 2016.1"/>
                        <field name="is_active" colspan="2"/>
                        <field name="data_i_frequencia" attrs="{'readonly': [('is_active', '=', False)]}"/>
                        <field name="intervalo_frequencia" colspan="2"
                               attrs="{'readonly': [('is_active', '=', False)]}"/>
                    </group>
                    <group string="Informações de Bolsas" col="4">
                        <field name="max_bolsas" colspan="2" string="Total" attrs="{'readonly': [('is_active', '=', False)]}"/>
                        <field name="bolsas_disponiveis" colspan="2" string="Não utilizadas"/>
                        <field name="bolsas_distribuidas" colspan="2" string="Distribuídas"/>
                        <field name="bolsas_n_distribuidas" colspan="2" string="Não Distribuídas"/>
                    </group>
                    <notebook>
                        <page string="Processos Seletivos"
                              attrs="{'invisible': ['|', ('id', '=', False), ('bolsas_curso_ids', '=', False)]}">
                            <field name="processos_seletivos_ids" attrs="{'readonly': [('is_active', '=', False)]}"
                                   context="{'semestre_id': id}"/>
                            <group string="Ações" attrs="{'invisible': ['|', ('id', '=', False), ('is_active', '=', False)]}">
                                <ul>
                                    <li>
                                        <button name="atualizar_status_processos_seletivos" string="Clique aqui" class="oe_link"
                                                type="object" confirm="Essa ação atualizará o status dos processos seletivos."/>
                                        para atualizar manualmente o status dos processos seletivos do semestre atual;
                                    </li>
                                    <li>
                                        <button name="%(ud_monitoria.action_ud_monitoria_disciplinas_para_ps_wizard)d" string="Clicar aqui"
                                                   class="oe_link" type="action"/>
                                        adicionar disciplinas a um processo seletivo em demanda.
                                    </li>
                                </ul>
                            </group>
                        </page>
                        <page string="Distribuição de Bolsas" groups="ud_monitoria.group_ud_monitoria_coordenador,ud_monitoria.group_ud_monitoria_administrador">
                            <field name="bolsas_curso_ids" attrs="{'readonly': [('is_active', '=', False)]}">
                                <tree editable="bottom" version="7.0" colors="green:is_active==True">
                                    <field name="id" invisible="1"/>
                                    <field name="curso_id" attrs="{'readonly': [('id', '!=', False)]}"
                                           options="{'no_open': true, 'create_edit': false, 'create': false}"/>
                                    <field name="bolsas"/>
                                    <field name="distribuidas"/>
                                    <field name="utilizadas"/>
                                    <field name="is_active"/>
                                </tree>
                            </field>
                            <div class="oe_right oe_button_box" groups="ud_monitoria.group_ud_monitoria_coordenador,ud_monitoria.group_ud_monitoria_administrador">
                                <button name="%(action_ud_monitoria_bolsas_curso_semestre_view)d" type="action"
                                        attrs="{'invisible': [('id', '=', False)]}"
                                        string="Mais detalhes"/>
                            </div>
                        </page>
                        <page string="Ocorrências" attrs="{'invisible': [('id', '=', False)]}"
                              groups="ud_monitoria.group_ud_monitoria_coordenador,ud_monitoria.group_ud_monitoria_administrador">
                            <field name="ocorrencias_ids" nolabel="1" attrs="{'readonly': [('is_active', '=', False)]}"/>
                            <p>
                                Mostra as ocorrências do semestre, tal como alterações de bolsa dos discentes.
                            </p>
                        </page>
                        <page string="Alteração de Bolsas" attrs="{'invisible': [('id', '=', False)]}"
                              groups="ud_monitoria.group_ud_monitoria_coordenador,ud_monitoria.group_ud_monitoria_administrador">
                        <button name='%(ud_monitoria.action_ud_monitoria_bolsa_adicionar_wizard)d' type='action'
                                string='Vincular Bolsa'/>
                        <button name='%(ud_monitoria.action_ud_monitoria_bolsa_remover_wizard_form_view)d' type='action'
                                string='Remover Bolsa'/>
                        <button name='%(ud_monitoria.ud_monitoria_bolsa_transferir_wizard_action)d' type='action'
                                string='Transferir Bolsa'/>
                    </page>
                    </notebook>
                </form>
            </field>
        </record>

        <!-- OCORRÊNCIA -->
        <record model="ir.ui.view" id="ud_monitoria_ocorrencia_tree_view">
            <field name="name">ud_monitoria.ocorrencia.tree</field>
            <field name="model">ud_monitoria.ocorrencia</field>
            <field name="type">tree</field>
            <field name="arch" type="xml">
                <tree string="Ocorrencias" edit="false" delete="false">
                    <field name="create_date"/>
                    <field name="name"/>
                    <field name="responsavel_id"/>
                </tree>
            </field>
        </record>

        <record model="ir.ui.view" id="ud_monitoria_ocorrencia_form_view">
            <field name="name">ud_monitoria.ocorrencia.form</field>
            <field name="model">ud_monitoria.ocorrencia</field>
            <field name="type">form</field>
            <field name="arch" type="xml">
                <form string="Ocorrência" version="7.0">
                    <group col="4">
                        <field name="name" colspan="2"/>
                        <field name="create_date" colspan="2"/>
                        <field name="responsavel_id" colspan="2"
                               context="{'form_view_ref': 'ud_monitoria.ud_employee_info_basicas_form_view'}"/>
                    </group>
                    <separator string="Descrição"/>
                    <field name="descricao"/>
                    <group string="Envolvidos">
                        <field name="envolvidos_ids" nolabel="1"
                               context="{'form_view_ref': 'ud_monitoria.ud_employee_info_basicas_form_view'}"/>
                    </group>
                    <p attrs="{'invisible': [('id', '!=', False)]}">
                        <strong>Atenção:</strong>
                        Uma vez salvo, uma ocorrência não poderá ser editada ou excluída.
                    </p>
                    <field name="id" invisible="1"/>
                </form>
            </field>
        </record>
    </data>
</openerp>