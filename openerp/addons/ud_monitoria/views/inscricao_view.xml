<?xml version="1.0" encoding="UTF-8" ?>

<openerp>
    <data>
        <!-- PONTUAÇÃO -->
        <record id="ud_monitoria_pontuacao_tree_view" model="ir.ui.view">
            <field name="name">ud_monitoria.pontuacao.tree</field>
            <field name="model">ud_monitoria.pontuacao</field>
            <field name="type">tree</field>
            <field name="arch" type="xml">
                <tree string="Pontuações" create="false" delete="false" editable="bottom">
                    <field name="criterio_avaliativo_id"/>
                    <field name="pontuacao"/>
                </tree>
            </field>
        </record>

        <record id="ud_monitoria_pontuacao_form_view" model="ir.ui.view">
            <field name="name">ud_monitoria.pontuacao.form</field>
            <field name="model">ud_monitoria.pontuacao</field>
            <field name="type">form</field>
            <field name="arch" type="xml">
                <form string="Pontuação" create="false" delete="false" version="7.0">
                    <group>
                        <field name="criterio_avaliativo_id"/>
                        <field name="pontuacao"/>
                    </group>
                    <separator string="Informações Adicionais"/>
                    <field name="info" nolabel="1"/>
                </form>
            </field>
        </record>

        <!-- INSCRIÇÃO -->
        <record id="action_ud_monitoria_inscricao_view" model="ir.actions.act_window">
            <field name="name">Inscritos</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">ud_monitoria.inscricao</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
        </record>

        <record id="action_ud_monitoria_minhas_inscricoes" model="ir.actions.act_window">
            <field name="name">Minhas Inscrições</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">ud_monitoria.inscricao</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="context">{'filtrar_discente': True}</field>
        </record>

        <record id="action_ud_monitoria_inscricao_orientador" model="ir.actions.act_window">
            <field name="name">Gerenciar Inscrições</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">ud_monitoria.inscricao</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="context">{'filtrar_orientador': True}</field>
            <field name="help" type="html">
                <div>
                    <p>
                        Inscrições não avaliadas que você seja Orientador de alguma disciplina serão mostradas aqui.
                    </p>
                </div>
            </field>
        </record>

        <record id="ud_monitoria_inscricao_tree" model="ir.ui.view">
            <field name="name">ud_monitoria.inscricao.tree</field>
            <field name="model">ud_monitoria.inscricao</field>
            <field name="type">tree</field>
            <field name="arch" type="xml">
                <tree string="Inscrições" create="false" colors="blue:state=='analise'">
                    <field name="perfil_id" invisible="context.get('filtrar_discente', False)"/>
                    <field name="discente_id" invisible="context.get('filtrar_discente', False)"/>
                    <field name="disciplina_id"/>
                    <field name="processo_seletivo_id"/>
                    <field name="tutoria"/>
                    <field name="bolsista"/>
                    <field name="state"/>
                </tree>
            </field>
        </record>

        <record id="ud_monitoria_inscricao_form" model="ir.ui.view">
            <field name="name">ud_monitoria.inscricao.form</field>
            <field name="model">ud_monitoria.inscricao</field>
            <field name="type">form</field>
            <field name="priority" eval="10"/>
            <field name="arch" type="xml">
                <form string="Inscrição" create="false" version="7.0">
                    <field name="id" invisible="1"/>
                    <field name="cpf_nome" invisible="1"/>
                    <field name="identidade_nome" invisible="1"/>
                    <field name="hist_analitico_nome" invisible="1"/>
                    <field name="certidao_vinculo_nome" invisible="1"/>
                    <header>
                        <field name="state" widget="statusbar" states="analise,classificado,desclassificado,reserva"/>
                    </header>
                    <group string="Dados Pessoais" col="4">
                        <field name="perfil_id" colspan="2" readonly="1"/>
                        <field name="discente_id" colspan="2" readonly="1" options="{'no_open': true}"/>
                        <field name="celular" colspan="2" readonly="1"/>
                        <field name="whatsapp" colspan="2" readonly="1"/>
                        <field name="telefone_fixo" colspan="2" readonly="1"/>
                        <field name="email" colspan="2" widget="email" readonly="1"/>
                        <field name="curso_id" colspan="2" readonly="1"/>
                    </group>
                    <group string="Documentos" col="4">
                        <field name="hist_analitico" colspan="2" readonly="1" filename="hist_analitico_nome"/>
                        <field name="certidao_vinculo" colspan="2" readonly="1" filename="certidao_vinculo_nome"/>
                        <field name="cpf" colspan="2" readonly="1" filename="cpf_nome"/>
                        <field name="identidade" colspan="2" readonly="1" filename="identidade_nome"/>
                    </group>
                    <group string="Dados da Inscrição" col="4">
                        <field name="processo_seletivo_id" colspan="2" readonly="1"/>
                        <field name="tutoria" colspan="2" readonly="1"/>
                        <field name="bolsas_curso_id" colspan="2" readonly="1"/>
                        <field name="disciplina_id" colspan="2" readonly="1"/>
                        <field name="orientador_id" colspan="2" readonly="1" options="{'no_open': true}"/>
                        <field name="bolsista" colspan="2" readonly="1"/>
                        <field name="dados_bancarios_id" options="{'no_open': true}" colspan="4" readonly="1"/>
                    </group>
                    <group string="Pontuações" col="4">
                        <field name="pontuacoes_ids" nolabel="1" colspan="4" readonly="1"/>
                        <field name="media" colspan="4"/>
                    </group>
                    <group string="Outras Informações" attrs="{'invisible': [('info', '=', False)]}">
                        <field name="info" nolabel="1" readonly="1"/>
                    </group>
                </form>
            </field>
        </record>

        <record id="ud_monitoria_inscricao_ps_form" model="ir.ui.view">
            <field name="name">ud_monitoria.inscricao.ps.form</field>
            <field name="model">ud_monitoria.inscricao</field>
            <field name="type">form</field>
            <field name="priority" eval="15"/>
            <field name="arch" type="xml">
                <form string="Inscrição" version="7.0">
                    <field name="id" invisible="1"/>
                    <field name="cpf_nome" invisible="1"/>
                    <field name="identidade_nome" invisible="1"/>
                    <field name="hist_analitico_nome" invisible="1"/>
                    <field name="certidao_vinculo_nome" invisible="1"/>
                    <group string="Dados Pessoais" col="4">
                        <field name="perfil_id" colspan="2" on_change="onchange_perfil_ou_bolsista(perfil_id, bolsista)"
                               options="{'create': false}"/>
                        <field name="discente_id" colspan="2" readonly="1" options="{'no_open': true}"/>
                        <field name="celular" colspan="2" class="telefone" attrs="{'readonly': [('id', '!=', False)]}"/>
                        <field name="whatsapp" colspan="2" class="telefone" attrs="{'readonly': [('id', '!=', False)]}"/>
                        <field name="telefone_fixo" colspan="2" class="telefone" attrs="{'readonly': [('id', '!=', False)]}"/>
                        <field name="email" colspan="2" attrs="{'readonly': [('id', '!=', False)]}"/>
                        <field name="curso_id" colspan="2" readonly="1" options="{'no_open': true}"/>
                    </group>
                    <group string="Documentos">
                        <field name="hist_analitico" filename="hist_analitico_nome"/>
                        <field name="certidao_vinculo" filename="certidao_vinculo_nome"/>
                        <field name="cpf" filename="cpf_nome"/>
                        <field name="identidade" filename="identidade_nome"/>
                    </group>
                    <group string="Dados da Inscrição" col="4">
                        <field name="processo_seletivo_id" colspan="2" on_change="onchage_processo_seletivo(processo_seletivo_id)"
                               options="{'no_open': true}" attrs="{'readonly': [('id', '!=', False)]}"/>
                        <field name="tutoria" colspan="2" on_change="onchange_tutoria()"
                               attrs="{'readonly': [('id', '!=', False)]}"/>
                        <field name="bolsas_curso_id" colspan="2" on_change="onchange_curso()"
                               attrs="{'readonly': [('id', '!=', False)]}" options="{'no_open': true}"/>
                        <field name="disciplina_id" colspan="2" on_change="onchange_disciplina(disciplina_id)"
                               attrs="{'readonly': [('id', '!=', False)]}" options="{'no_open': true}"/>
                        <field name="bolsista" colspan="2" on_change="onchange_perfil_ou_bolsista(perfil_id, bolsista)"
                               attrs="{'readonly': [('id', '!=', False)]}"/>
                        <field name="orientador_id" colspan="2" readonly="1" options="{'no_open': true}"/>
                        <field name="dados_bancarios_id" colspan="4" options="{'no_open': true}"
                               context="{'form_view_ref': 'ud.ud_dados_bancarios_usuario_form', 'proprietario_conta': discente_id}"
                               attrs="{'invisible': [('bolsista', '=', False)], 'readonly': ['|', ('discente_id', '=', False), ('id', '!=', False)]}"/>
                    </group>
                    <div attrs="{'invisible': [('bolsista', '=', False)]}" style="color: red;">
                        <strong>Atenção:</strong> A conta deve pertencer ao discente e não deve ser do tipo Poupança nem Conta Fácil.
                    </div>
                    <footer>
                        <button name="acao" string="Inscrever" type="object" class="oe_highlight"/>
                        ou
                        <button string="Cancelar" class="oe_link" special="cancel"/>
                    </footer>
                </form>
            </field>
        </record>

        <record id="ud_monitoria_inscricao_pontuacoes_form" model="ir.ui.view">
            <field name="name">ud_monitoria.inscricao.pontuacoes.form</field>
            <field name="model">ud_monitoria.inscricao</field>
            <field name="inherit_id" ref="ud_monitoria_inscricao_form"/>
            <field name="groups_id" eval="[(6, 0, [ref('ud_monitoria.group_ud_monitoria_orientador'), ref('ud_monitoria.group_ud_monitoria_coordenador'), ref('ud_monitoria.group_ud_monitoria_administrador')])]"/>
            <field name="arch" type="xml">
                <field name="pontuacoes_ids" position="attributes">
                    <attribute name="readonly"/>
                    <attribute name="on_change">onchange_pontuacoes(pontuacoes_ids)</attribute>
                    <attribute name="attrs">{'readonly': [('state', '!=', 'analise')]}</attribute>
                </field>
                <xpath expr="//form" position="inside">
                    <field name="com_concorrencia" invisible="1"/>
                    <group string="Ações" attrs="{'invisible': [('state', '!=', 'analise')]}">
                        <div>
                            Você pode realizar uma das seguintes ações para definir o status do(a) discente:
                            <ul>
                                <li>
                                    Enviar para o <button name="cadastro_reserva" type="object" string="cadastro de reserva" class="oe_link"
                                                          confirm="Você está prestes a deixar o(a) discente no cadastro de reserva."/>;
                                </li>
                                <li attrs="{'invisible': [('bolsista', '=', True)]}">
                                    <button name="classificar_media_bolsa" type="object" string="Classificar" class="oe_link"
                                            confirm="Você classificará o(a) discente colaborador(a) como bolsista."/>
                                    o(a) discente colaborador(a) como <strong>bolsista</strong>;
                                </li>
                                <li attrs="{'invisible': [('bolsista', '=', False)]}">
                                    <button name="classificar_media_s_bolsa" type="object" string="Classificar" class="oe_link"
                                            confirm="Você classificará o(a) discente bolsita como colaborador(a)."/>
                                    o(a) discente bolsista como <strong>colaborador(a)</strong>;
                                </li>
                                <li>
                                    <button name="classificar_media" type="object" string="Classificar" class="oe_link"
                                            confirm="Você classificará o(a) discente."/> o(a) discente;
                                </li>
                                <li>
                                    <button name="desclassificar" type="object" string="Desclassificar" class="oe_link"
                                            confirm="Você desclassificará o(a) discente."/> o(a) discente.
                                </li>
                            </ul>
                        </div>
                        <div attrs="{'invisible': [('com_concorrencia', '=', True)]}"
                                groups="ud_monitoria.group_ud_monitoria_coordenador,ud_monitoria.group_ud_monitoria_administrador">
                            Como não ha concorrência, é possível utilizar uma das ações abaixo:
                            <ul>
                                <li attrs="{'invisible': [('bolsista', '=', True)]}">
                                    <button name="classificar_direto_bolsa" type="object" string="Classificar" class="oe_link"
                                            confirm="Você classificará o(a) discente colaborador(a) como bolsista."/>
                                    o(a) discente colaborador(a) como <strong>bolsista</strong>;
                                </li>
                                <li attrs="{'invisible': [('bolsista', '=', False)]}">
                                    <button name="classificar_direto_s_bolsa" type="object" string="Classificar" class="oe_link"
                                            confirm="Você classificará o(a) discente bolsista como colaborador(a)."/>
                                    o(a) discente bolsista como <strong>colaborador(a)</strong>;
                                </li>
                                <li>
                                    <button name="classificar_direto" type="object" string="Classificar" class="oe_link"
                                            confirm="Você classificará o(a) discente IGNORANDO sua pontuação."/>
                                    o(a) discente.
                                </li>
                            </ul>
                        </div>
                    </group>
                </xpath>

            </field>
        </record>

        <record id="ud_monitoria_inscricao_documentos_form" model="ir.ui.view">
            <field name="name">ud_monitoria.inscricao.documentos.form</field>
            <field name="model">ud_monitoria.inscricao</field>
            <field name="inherit_id" ref="ud_monitoria_inscricao_form"/>
            <field name="groups_id" eval="[(6, 0, [ref('ud_monitoria.group_ud_monitoria_coordenador'), ref('ud_monitoria.group_ud_monitoria_administrador')])]"/>
            <field name="arch" type="xml">
                <field name="hist_analitico" position="attributes">
                    <attribute name="attrs">{'readonly': [('state', '!=', 'analise')]}</attribute>
                </field>
                <field name="cpf" position="attributes">
                    <attribute name="attrs">{'readonly': [('state', '!=', 'analise')]}</attribute>
                </field>
                <field name="identidade" position="attributes">
                    <attribute name="attrs">{'readonly': [('state', '!=', 'analise')]}</attribute>
                </field>
            </field>
        </record>

        <record id="ud_monitoria_inscricao_admin_form" model="ir.ui.view">
            <field name="name">ud_monitoria.inscricao.admin.form</field>
            <field name="model">ud_monitoria.inscricao</field>
            <field name="inherit_id" ref="ud_monitoria_inscricao_form"/>
            <field name="groups_id" eval="[(6, 0, [ref('ud_monitoria.group_ud_monitoria_administrador')])]"/>
            <field name="arch" type="xml">
                <field name="tutoria" position="attributes">
                    <attribute name="readonly"/>
                    <attribute name="attrs">{'readonly': [('state', '!=', 'analise')]}</attribute>
                </field>
                <field name="bolsas_curso_id" position="attributes">
                    <attribute name="readonly"/>
                    <attribute name="attrs">{'readonly': [('state', '!=', 'analise')]}</attribute>
                    <attribute name="on_change">onchange_curso()</attribute>
                </field>
                <field name="disciplina_id" position="attributes">
                    <attribute name="readonly"/>
                    <attribute name="attrs">{'readonly': [('state', '!=', 'analise')]}</attribute>
                    <attribute name="on_change">onchange_disciplina(disciplina_id)</attribute>
                </field>
                <field name="bolsista" position="attributes">
                    <attribute name="readonly"/>
                    <attribute name="attrs">{'readonly': [('state', '!=', 'analise')]}</attribute>
                    <attribute name="on_change">onchange_perfil_ou_bolsista(perfil_id, bolsista)</attribute>
                </field>
                <field name="orientador_id" position="attributes">
                    <attribute name="options"/>
                </field>
                <field name="dados_bancarios_id" position="attributes">
                    <attribute name="readonly"/>
                    <attribute name="attrs">{'readonly': [('state', '!=', 'analise')]}</attribute>
                    <attribute name="context">{'form_view_ref': 'ud.ud_dados_bancarios_usuario_form', 'proprietario_conta': discente_id}</attribute>
                </field>
            </field>
        </record>

        <record id="action_ud_monitoria_inscricao_discente_view" model="ir.actions.act_window">
            <field name="name">Inscrição</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">ud_monitoria.inscricao</field>
            <field name="view_type">form</field>
            <field name="view_mode">form</field>
            <field name="view_id" ref="ud_monitoria_inscricao_ps_form"/>
            <field name="target">new</field>
        </record>
    </data>
</openerp>