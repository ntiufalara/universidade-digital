<?xml version="1.0" encoding="UTF-8" ?>

<openerp>
    <data>
        <!-- DISCIPLINA PROCESSO SELETIVO -->
        <record id="ud_monitoria_disciplina_ps_tree" model="ir.ui.view">
            <field name="name">ud_monitoria.disciplina_ps.tree</field>
            <field name="model">ud_monitoria.disciplina_ps</field>
            <field name="type">tree</field>
            <field name="arch" type="xml">
                <tree string="Disciplinas" colors="blue:is_active==True">
                    <field name="disc_monit_id"/>
                    <field name="bolsas_curso_id"/>
                    <field name="orientador_id"/>
                    <field name="bolsistas"/>
                    <field name="colaboradores"/>
                    <field name="tutoria"/>
                    <field name="is_active" invisible="1"/>
                </tree>
            </field>
        </record>

        <record id="ud_monitoria_disciplina_ps_form" model="ir.ui.view">
            <field name="name">ud_monitoria.disciplina_ps.form</field>
            <field name="model">ud_monitoria.disciplina_ps</field>
            <field name="type">form</field>
            <field name="arch" type="xml">
                <form string="Disciplina" version="7.0">
                    <field name="id"/>
                    <group>
                        <field name="disc_monit_id" on_change="onchange_disciplina_monitoria(disc_monit_id)"
                               attrs="{'readonly': [('id', '!=', False)]}"
                               context="{'semestre_id': context.get('semestre_id', False), 'coordenador_monitoria_curso': context.get('coordenador_monitoria_curso', False)}"
                               options="{'no_open': true, 'create': false, 'create_edit': false, 'm2o_dialog': false}"/>
                    </group>
                    <div style="color: red">
                        <strong>Atenção:</strong> As informações mostradas estão diretamente relacionadas ao
                        semestre, não ao processo seletivo. Isso quer dizer que elas podem ser atualizadas posteriormente.
                    </div>
                    <group string="Detalhes" col="4" attrs="{'invisible': [('disc_monit_id', '=', False)]}">
                        <field name="semestre_id" colspan="2" readonly="1" options="{'no_open': true}"/>
                        <field name="bolsas_curso_id" colspan="2" readonly="1"/>
                        <field name="data_inicial" colspan="2" readonly="1"/>
                        <field name="data_final" colspan="2" readonly="1"/>
                        <field name="tutoria" colspan="2" readonly="1"/>
                        <field name="perfil_id" colspan="2" readonly="1" options="{'no_open': true}"
                               groups="ud_monitoria.group_ud_monitoria_coord_disciplina,ud_monitoria.group_ud_monitoria_coordenador,ud_monitoria.group_ud_monitoria_administrador"/>
                        <field name="orientador_id" colspan="4" readonly="1" options="{'no_open': true}"/>
                    </group>
                    <group string="Vagas" col="4" attrs="{'invisible': [('disc_monit_id', '=', False)]}">
                        <field name="bolsistas" colspan="2" readonly="1"/>
                        <field name="colaboradores" colspan="2" readonly="1"/>
                    </group>
                    <group string="Informações de Bolsas" col="4" attrs="{'invisible': [('disc_monit_id', '=', False)]}"
                           groups="ud_monitoria.group_ud_monitoria_coord_disciplina,ud_monitoria.group_ud_monitoria_coordenador,ud_monitoria.group_ud_monitoria_administrador">
                        <field name="bolsas_utilizadas" colspan="2"/>
                        <field name="bolsas_disponiveis" colspan="2"/>
                    </group>
                    <group string="Disciplinas"  attrs="{'invisible': [('disc_monit_id', '=', False)]}">
                        <field name="disciplina_ids" nolabel="1" readonly="1" options="{'no_open': true}">
                            <tree string="Disciplina">
                                <field name="codigo"/>
                                <field name="name"/>
                                <field name="periodo"/>
                            </tree>
                        </field>
                    </group>
                </form>
            </field>
        </record>

        <!-- CRITÉRIO AVALIATIVO -->
        <record id="action_ud_monitoria_criterio_avaliativo_view" model="ir.actions.act_window">
            <field name="name">Critério Avaliativo</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">ud_monitoria.criterio_avaliativo</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
        </record>

        <record id="ud_monitoria_criterio_avaliativo_tree_view" model="ir.ui.view">
            <field name="name">ud_monitoria.criterio_avaliativo.tree</field>
            <field name="model">ud_monitoria.criterio_avaliativo</field>
            <field name="type">tree</field>
            <field name="arch" type="xml">
                <tree string="Critérios Avaliativos">
                    <field name="name"/>
                    <field name="peso" invisible="context.get('tipo_media', False) == 'a'"/>
                </tree>
            </field>
        </record>

        <record id="ud_monitoria_criterio_avaliativo_form_view" model="ir.ui.view">
            <field name="name">ud_monitoria.criterio_avaliativo.form</field>
            <field name="model">ud_monitoria.criterio_avaliativo</field>
            <field name="type">form</field>
            <field name="arch" type="xml">
                <form string="Critério Avaliativo" version="7.0">
                    <div>
                        <strong>Atenção:</strong> A presença do campo "Peso" não quer dizer que será adotado para o
                        cálculo da média final do discente. Isso irá depender exclusivamente das configurações definidas
                        pela coordenação para cada processo seletivo.
                    </div>
                    <group col="4">
                        <field name="name" colspan="2"/>
                        <field name="peso" colspan="2"/>
                    </group>
                    <separator string="Descrição"/>
                    <field name="descricao" nolabel="1"/>
                </form>
            </field>
        </record>

        <!-- ANEXOS -->
        <record id="action_ud_monitoria_anexo_view" model="ir.actions.act_window">
            <field name="name">Anexos</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">ud_monitoria.anexo</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
        </record>

        <record id="ud_monitoria_anexo_tree_view" model="ir.ui.view">
            <field name="name">ud_monitoria.anexo.tree</field>
            <field name="model">ud_monitoria.anexo</field>
            <field name="type">tree</field>
            <field name="arch" type="xml">
                <tree string="Anexos" delete="false">
                    <field name="name" invisible="1"/>
                    <field name="arquivo" filename="name"/>
                    <field name="create_date"/>
                </tree>
            </field>
        </record>

        <record id="ud_monitoria_anexo_form_view" model="ir.ui.view">
            <field name="name">ud_monitoria.anexo.form</field>
            <field name="model">ud_monitoria.anexo</field>
            <field name="type">form</field>
            <field name="arch" type="xml">
                <form string="Anexo" version="7.0" delete="false">
                    <field name="name" invisible="1"/>
                    <field name="processo_seletivo_id" invisible="1"/>
                    <group>
                        <field name="arquivo" filename="name" attrs="{'readonly': [('processo_seletivo_id', '!=', False)]}"/>
                    </group>
                </form>
            </field>
        </record>

        <record id="ud_monitoria_anexo_admin_tree_view" model="ir.ui.view">
            <field name="name">ud_monitoria.anexo.admin.form</field>
            <field name="model">ud_monitoria.anexo</field>
            <field name="inherit_id" ref="ud_monitoria_anexo_tree_view"/>
            <field name="groups_id" eval="[(6, 0, [ref('ud_monitoria.group_ud_monitoria_administrador')])]"/>
            <field name="arch" type="xml">
                <xpath expr="//tree" position="attributes">
                    <attribute name="delete"/>
                </xpath>
            </field>
        </record>

        <record id="ud_monitoria_anexo_admin_form_view" model="ir.ui.view">
            <field name="name">ud_monitoria.anexo.admin.form</field>
            <field name="model">ud_monitoria.anexo</field>
            <field name="inherit_id" ref="ud_monitoria_anexo_form_view"/>
            <field name="groups_id" eval="[(6, 0, [ref('ud_monitoria.group_ud_monitoria_administrador')])]"/>
            <field name="arch" type="xml">
                <xpath expr="//form" position="attributes">
                    <attribute name="delete"/>
                </xpath>
            </field>
        </record>

        <!-- PROCESSO SELETIVO -->
        <record id="action_ud_monitoria_processo_seletivo_view" model="ir.actions.act_window">
            <field name="name">Processos Seletivos</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">ud_monitoria.processo_seletivo</field>
            <field name="context">{'filtro_coordenador': True}</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
        </record>

        <record id="ud_monitoria_processo_seletivo_tree_view" model="ir.ui.view">
            <field name="name">ud_monitoria.processo_seletivo.tree</field>
            <field name="model">ud_monitoria.processo_seletivo</field>
            <field name="priority" eval="10"/>
            <field name="type">tree</field>
            <field name="arch" type="xml">
                <tree string="Processos Seletivos" colors="blue:state=='andamento';red:state=='invalido'">
                    <field name="name"/>
                    <field name="data_inicio"/>
                    <field name="data_fim"/>
                    <field name="semestre_id"/>
                    <field name="state"/>
                </tree>
            </field>
        </record>

        <record id="ud_monitoria_processo_seletivo_form_view" model="ir.ui.view">
            <field name="name">ud_monitoria.processo_seletivo.form</field>
            <field name="model">ud_monitoria.processo_seletivo</field>
            <field name="priority" eval="10"/>
            <field name="type">form</field>
            <field name="arch" type="xml">
                <form string="Processo Seletivo" version="7.0" edit="false">
                    <header>
                        <button name="%(action_ud_monitoria_inscricao_discente_view)d" type="action"
                                string="Inscrever" states="andamento" class="oe_highlight"/>
                        <field name="state" widget="statusbar" states="novo,andamento,encerrado" statusbar_visible="novo,andamento,encerrado"/>
                    </header>
                    <field name="id"/>
                    <div style="color: red;" attrs="{'invisible': [('state', '!=', 'invalido')]}"
                         groups="ud_monitoria.group_ud_monitoria_coordenador,ud_monitoria.group_ud_monitoria_administrador">
                        <p>
                            O processo seletivo torna-se inválido quando está fora do prazo de demanada e não possui ao
                            menos um anexo ou disciplina.
                        </p>
                    </div>
                    <group col="4">
                        <field name="name" colspan="4" placeholder="Nome do Processo Seletivo"
                               attrs="{'readonly': [('state', 'in', ['andamento', 'encerrado'])]}"/>
                        <field name="data_inicio" colspan="2" attrs="{'readonly': [('id', '!=', False), ('state', 'not in', ['demanda', 'invalido', 'novo'])]}"/>
                        <field name="data_fim" colspan="2"/>
                        <field name="semestre_id" colspan="2" options="{'no_open': 1}"
                               invisible="context.get('semestre_id', False)"
                               attrs="{'readonly': ['|', ('id', '!=', False), ('state', 'in', ['andamento', 'encerrado'])]}"/>
                        <field name="valor_bolsa" colspan="2" attrs="{'readonly': [('state', 'in', ['andamento', 'encerrado'])]}"/>
                    </group>
                    <notebook attrs="{'invisible': ['|', ('name', '=', False), '|', ('data_inicio', '=', False), '|', ('data_fim', '=', False), ('semestre_id', '=', False)]}">
                        <page string="Anexos">
                            <field name="anexos_ids" nolabel="1"/>
                        </page>
                        <page string="Disciplinas" attrs="{'invisible': [('state', '=', False)]}">
                            <field name="disciplinas_ids" nolabel="1" context="{'semestre_id': semestre_id}"
                                   attrs="{'readonly': [('state', 'in', ['novo', 'andamento', 'encerrado'])]}"/>
                        </page>
                        <page string="Critérios Avaliativos">
                            <group col="4">
                                <field name="tipo_media" colspan="2" attrs="{'readonly': [('state', 'not in', [False, 'demanda', 'invalido'])]}"/>
                                <field name="media_minima" colspan="2" attrs="{'readonly': [('state', 'not in', [False, 'demanda', 'invalido'])]}"/>
                            </group>
                            <field name="criterios_avaliativos_ids" nolabel="1" context="{'tipo_media': tipo_media}"
                                   attrs="{'readonly': [('state', 'in', ['novo', 'andamento', 'encerrado'])]}"/>
                        </page>
                    </notebook>
                </form>
            </field>
        </record>

        <record id="ud_monitoria_processo_seletivo_coord_disc_form_view" model="ir.ui.view">
            <field name="name">ud_monitoria.processo_seletivo.coordenandor.form</field>
            <field name="model">ud_monitoria.processo_seletivo</field>
            <field name="inherit_id" ref="ud_monitoria_processo_seletivo_form_view"/>
            <field name="groups_id" eval="[(6, 0, [ref('ud_monitoria.group_ud_monitoria_coord_disciplina'), ref('ud_monitoria.group_ud_monitoria_coordenador'), ref('ud_monitoria.group_ud_monitoria_administrador')])]"/>
            <field name="arch" type="xml">
                <field name="state" position="attributes">
                    <attribute name="states">demanda,novo,andamento,encerrado</attribute>
                    <attribute name="statusbar_visible">demanda,novo,andamento,encerrado</attribute>
                </field>
                <field name="name" position="attributes">
                    <attribute name="colspan">2</attribute>
                </field>
                <field name="name" position="after">
                    <field name="prazo_demanda" colspan="2" readonly="1"/>
                </field>
            </field>
        </record>

        <record id="ud_monitoria_processo_seletivo_coordenador_tree_view" model="ir.ui.view">
            <field name="name">ud_monitoria.processo_seletivo.tree</field>
            <field name="model">ud_monitoria.processo_seletivo</field>
            <field name="inherit_id" ref="ud_monitoria_processo_seletivo_tree_view"/>
            <field name="groups_id" eval="[(6, 0, [ref('ud_monitoria.group_ud_monitoria_coordenador'), ref('ud_monitoria.group_ud_monitoria_administrador')])]"/>
            <field name="arch" type="xml">
                <field name="name" position="after">
                    <field name="prazo_demanda"/>
                </field>
            </field>
        </record>

        <record id="ud_monitoria_processo_seletivo_coordenador_form_view" model="ir.ui.view">
            <field name="name">ud_monitoria.processo_seletivo.coordenandor.form</field>
            <field name="model">ud_monitoria.processo_seletivo</field>
            <field name="inherit_id" ref="ud_monitoria_processo_seletivo_coord_disc_form_view"/>
            <field name="groups_id" eval="[(6, 0, [ref('ud_monitoria.group_ud_monitoria_coordenador'), ref('ud_monitoria.group_ud_monitoria_administrador')])]"/>
            <field name="arch" type="xml">
                <xpath expr="//form" position="attributes">
                    <attribute name="edit"/>
                </xpath>
                <xpath expr="//notebook" position="inside">
                    <page string="Inscrições">
                        <field name="inscricoes_ids" nolabel="1">
                            <tree create="false" delete="false">
                                <field name="perfil_id"/>
                                <field name="discente_id"/>
                                <field name="disciplina_id"/>
                                <field name="tutoria"/>
                                <field name="bolsista"/>
                                <field name="state"/>
                            </tree>
                        </field>
                    </page>
                </xpath>
                <field name="state" position="attributes">
                    <attribute name="states">demanda,invalido,novo,andamento,encerrado</attribute>
                    <attribute name="statusbar_visible">demanda,invalido,novo,andamento,encerrado</attribute>
                </field>
                <field name="name" position="attributes">
                    <attribute name="colspan">2</attribute>
                </field>
                <field name="prazo_demanda" position="attributes">
                    <attribute name="readonly"/>
                    <attribute name="attrs">{'readonly': ['|', ('inscricoes_ids', '!=', []), '&amp;', ('id', '!=', False), ('state', 'not in', ['demanda', 'invalido', 'novo'])]}</attribute>
                </field>
                <field name="semestre_id" position="attributes">
                    <attribute name="options"/>
                </field>
            </field>
        </record>

        <record id="ud_monitoria_processo_seletivo_admin_form" model="ir.ui.view">
            <field name="name">ud_monitoria.processo_seletivo.coordenandor.form</field>
            <field name="model">ud_monitoria.processo_seletivo</field>
            <field name="inherit_id" ref="ud_monitoria_processo_seletivo_coordenador_form_view"/>
            <field name="groups_id" eval="[(6, 0, [ref('ud_monitoria.group_ud_monitoria_administrador')])]"/>
            <field name="arch" type="xml">
                <field name="criterios_avaliativos_ids" position="attributes">
                    <attribute name="attrs"/>
                </field>
                <field name="criterios_avaliativos_ids" position="before">
                    <div class="oe_edit_only" style="color: red" attrs="{'invisible': [('inscricoes_ids', '=', [])]}">
                        <strong>ATENÇÃO:</strong> Não adicione nem exclua critérios avaliativos, pois causará
                        <strong>incosistência nos dados</strong> das inscrições.
                        <span style="text-decoration: underline">A única ação segura é edição de informações já
                            existentes</span>.
                    </div>
                </field>
            </field>
        </record>

        <!-- PROCESSO SELETIVO: Solicitação de disciplina -->
        <record id="ud_monitoria_processo_seletivo_demanda_tree_view" model="ir.ui.view">
            <field name="name">ud_monitoria.processo_seletivo.tree</field>
            <field name="model">ud_monitoria.processo_seletivo</field>
            <field name="priority" eval="20"/>
            <field name="type">tree</field>
            <field name="arch" type="xml">
                <tree string="Processos Seletivos" create="false" delete="false">
                    <field name="name" string="Processo Seletivo"/>
                    <field name="prazo_demanda"/>
                    <field name="semestre_id"/>
                </tree>
            </field>
        </record>

        <record id="ud_monitoria_processo_seletivo_demanda_form_view" model="ir.ui.view">
            <field name="name">ud_monitoria.processo_seletivo.form</field>
            <field name="model">ud_monitoria.processo_seletivo</field>
            <field name="priority" eval="15"/>
            <field name="type">form</field>
            <field name="arch" type="xml">
                <form string="Demanda de Disciplinas" version="7.0" create="false" delete="false">
                    <group col="4">
                        <field name="name" string="Processo Seletivo" readonly="1" colspan="2"/>
                        <field name="semestre_id" readonly="1" colspan="2"/>
                    </group>
                    <group string="Disciplinas">
                        <field name="disciplinas_ids" nolabel="1"
                               context="{'semestre_id': semestre_id, 'coordenador_monitoria_curso': True}"/>
                    </group>
                    <div>
                        <strong>Atenção:</strong> Antes de solicitar uma disciplina, primeiro é necessário realizar sua
                        liberação no menu
                        <button name="%(action_ud_monitoria_bolsas_curso_liberacao_disciplina_view)d" type="action"
                                string="Liberação de Disciplinas" class="oe_link"/>.
                    </div>
                </form>
            </field>
        </record>

        <record id="action_ud_monitoria_demanda_view" model="ir.actions.act_window">
            <field name="name">Solicitação de Disciplinas</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">ud_monitoria.processo_seletivo</field>
            <field name="context">{'coordenador_monitoria_curso': True}</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="domain">[('state', '=', 'demanda')]</field>
            <field name="help" type="html">
                <div>
                    <p>
                        Será possível solicitar disciplinas quando existirem processos seletivos em fase de demanda.
                    </p>
                    <p>
                        <strong>Obs.:</strong> Estarão disponíveis as disciplinas que tiverem sido liberadas para o semestre.
                    </p>
                </div>
            </field>
        </record>

        <record id="action_ud_monitoria_demanda_view_tree" model="ir.actions.act_window.view">
            <field name="sequence" eval="1"/>
            <field name="view_id" ref="ud_monitoria_processo_seletivo_demanda_tree_view"/>
            <field name="view_mode">tree</field>
            <field name="act_window_id" ref="action_ud_monitoria_demanda_view"/>
        </record>

        <record id="action_ud_monitoria_demanda_view_form" model="ir.actions.act_window.view">
            <field name="sequence" eval="2"/>
            <field name="view_id" ref="ud_monitoria_processo_seletivo_demanda_form_view"/>
            <field name="view_mode">form</field>
            <field name="act_window_id" ref="action_ud_monitoria_demanda_view"/>
        </record>

        <record id="ud_monitoria_processo_seletivo_search" model="ir.ui.view">
            <field name="name">Pesquisar Processos Seletivos</field>
            <field name="model">ud_monitoria.processo_seletivo</field>
            <field name="type">search</field>
            <field name="arch" type="xml">
                <search string="Processo Seletivo">
                    <field name="name"/>
                    <filter string="Inválido" name="Inválido" help="Mostra os processos seletivos inválidos."
                            groups="ud_monitoria.group_ud_monitoria_coordenador,ud_monitoria.group_ud_monitoria_administrador"
                            domain="[('state', '=', 'invalido')]"/>
                    <filter string="Em damanda" name="demanda" help="Mostra os processos seletivos em demanda."
                            groups="ud_monitoria.group_ud_monitoria_coord_disciplina,ud_monitoria.group_ud_monitoria_coordenador,ud_monitoria.group_ud_monitoria_administrador"
                            domain="[('state', '=', 'demanda')]"/>
                    <filter string="Novo" name="novo" help="Mostra os novos processos seletivos."
                            domain="[('state', '=', 'novo')]"/>
                    <filter string="Em andamento" name="andamento" help="Mostra os processos seletivos em andamento."
                            domain="[('state', '=', 'andamento')]"/>
                    <filter string="Encerrado" name="encerrado" help="Mostra os processos seletivos encerrados."
                            domain="[('state', '=', 'encerrado')]"/>
                    <group expand="0" string="Agrupar por...">
                        <filter string="Semestre" name="semestre" context="{'group_by': 'semestre_id'}"
								help="Agrupar por semestre"/>
                        <filter string="Status" name="status" context="{'group_by': 'state'}"
								help="Agrupar por status"/>
                    </group>
                </search>
            </field>
        </record>
    </data>
</openerp>